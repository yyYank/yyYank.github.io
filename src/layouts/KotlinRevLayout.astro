---
import BaseLayout from './BaseLayout.astro';
import KotlinRevSidebar from '../components/KotlinRevSidebar.astro';
import { getCollection } from 'astro:content';

interface Props {
  title: string;
  description?: string;
}

const { title, description } = Astro.props;
const allDocs = await getCollection('kotlinrev', ({ data, slug }) => !data.draft && slug !== 'index');
const sortedDocs = allDocs.sort((a, b) => (a.data.order ?? 100) - (b.data.order ?? 100));

const currentPath = Astro.url.pathname;
const currentSlug = currentPath.replace(/^\/kotlin-rev\//, '').replace(/\/$/, '');
---

<BaseLayout title={title} description={description}>
  <div class="container mx-auto px-4 py-8">
    <div class="flex flex-col md:flex-row gap-8">
      <aside class="w-full md:w-64 flex-shrink-0">
        <KotlinRevSidebar docs={sortedDocs} currentSlug={currentSlug} />
      </aside>
      <article class="flex-grow min-w-0 prose prose-lg prose-invert max-w-none">
        <slot />
      </article>
    </div>
  </div>
</BaseLayout>
